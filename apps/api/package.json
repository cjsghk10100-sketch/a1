{
  "name": "@agentapp/api",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "db:migrate": "tsx scripts/migrate.ts",
    "db:status": "tsx scripts/migrate_status.ts",
    "dev": "tsx watch src/index.ts",
    "audit:verify-chain": "tsx scripts/verify_hash_chain.ts",
    "lifecycle:daily": "tsx scripts/lifecycle_automation.ts",
    "runs:worker": "tsx scripts/run_worker.ts",
    "runs:worker:watch": "RUN_WORKER_ONCE=false tsx scripts/run_worker.ts",
    "secrets:rotate-key": "tsx scripts/rotate_secrets_master_key.ts",
    "snapshot:daily": "tsx scripts/snapshot_daily.ts",
    "survival:daily": "tsx scripts/survival_rollup.ts",
    "start": "tsx src/index.ts",
    "test": "AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_room_sse.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_stream_session_cookie.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_audit_hash_chain.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_approvals.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_policy_enforcement.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_auth_bootstrap_owner.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_learning_constraints.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_runs.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_evidence_manifest.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_experiments.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_scorecards_lessons.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_promotion_loop.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_run_claim.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_engine_token_body_auth.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_engine_claim_lease.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_engine_bearer_refresh.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_run_worker.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_run_worker_egress.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_run_worker_tool_policy.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_run_worker_embedded.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_events_query.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_search.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_discord_ingest.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_discord_event_parse.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_discord_emoji_mapping.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_capabilities.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_engines.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_egress.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_skill_packages.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_agents_onboarding.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_toolcalls.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_artifacts.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_secrets.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_trust.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_skill_ledger.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_snapshots.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_survival.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_lifecycle.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_data_access.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_agent_quarantine.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_principals.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_incidents.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_kernel_invariants.ts",
    "test:rerun-safety": "AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_learning_constraints.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_discord_ingest.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_discord_event_parse.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_discord_emoji_mapping.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_skill_packages.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_agents_onboarding.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_secrets.ts && AUTH_ALLOW_LEGACY_WORKSPACE_HEADER=1 tsx test/contract_lifecycle.ts",
    "typecheck": "pnpm -w exec tsc -p apps/api/tsconfig.json"
  },
  "dependencies": {
    "@agentapp/shared": "workspace:*",
    "fastify": "^4.29.1",
    "pg": "^8.11.5"
  },
  "devDependencies": {
    "@types/pg": "^8.11.6",
    "tsx": "^4.19.0"
  }
}
