# KERNEL_INVARIANTS_CHECKLIST

목적: 재설계/확장 시 커널 무결성을 지키기 위한 불변 조건 체크리스트.

## A. 이벤트 저장소 불변성
- [ ] 이벤트 저장소는 append-only를 유지한다 (UPDATE/DELETE 금지).
- [ ] 이벤트 타입 의미를 깨는 변경은 금지한다.
- [ ] correlation/causation 연결 규칙을 유지한다.
- [ ] 이벤트 리플레이 시 동일 상태가 재현된다.

## B. 승인 경계 불변성
- [ ] Request ≠ Execute 경계를 유지한다.
- [ ] 승인 없는 고위험 실행(L2/L3)은 금지한다.
- [ ] approval_id, request_hash 연결 검증 로직을 유지한다.
- [ ] 승인 정책 우회 경로(직접 실행) 추가를 금지한다.

## C. 실행/증거 불변성
- [ ] 모든 run은 evidence 연결 없이는 성공 종료 금지.
- [ ] run 상태 전이는 유효 상태머신 내에서만 허용.
- [ ] 증거 매니페스트(요약+원본 포인터+무결성 해시) 규약을 유지.
- [ ] 핵심 산출물(log/artifact/check/metric)의 누락 감지를 유지.

## D. 보안/권한 불변성
- [ ] 최소권한 원칙(Least Privilege) 유지.
- [ ] secrets/redaction은 persist 이전 단계에서 강제.
- [ ] 외부 도구/스킬 도입 시 공급망 검증 루프를 유지.
- [ ] kill switch/중단 트리거는 언제나 우선권을 가진다.

## E. 운영 모델 불변성
- [ ] Work/Observation/Control 분리 관점을 유지.
- [ ] 커널에 도메인 비즈니스 로직 직접 주입 금지.
- [ ] 확장은 플레이북/정책/실험 객체로 올린다.
- [ ] 변경 순서 규칙(공통헌법→SOUL→실행파일)을 유지한다.

## F. 실패 조건 (즉시 중단)
아래 중 하나라도 위반 시 변경 작업 중단:
- [ ] 이벤트 리플레이 불일치
- [ ] 승인 경계 우회 가능
- [ ] 증거 없는 성공 처리 가능
- [ ] 권한/시크릿 경계 약화
